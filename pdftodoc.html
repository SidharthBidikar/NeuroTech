<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF to DOC Converter Online - Free Tool to Convert PDF to Word</title>
  <meta name="description" content="Convert PDF to DOC online for free with our advanced PDF to DOC converter. Transform PDFs into editable Word documents for seamless editing and sharing.">
  <meta name="keywords" content="PDF to DOC converter, convert PDF to DOC online, free PDF to DOC tool, PDF to Word converter, PDF to DOC free, PDF document converter">
  <meta name="robots" content="index, follow">
  <meta name="author" content="PDF Converter Team">
  <meta property="og:title" content="PDF to DOC Converter Online - Free Tool">
  <meta property="og:description" content="Easily convert PDF files to editable DOC format with our free online tool. Perfect for editing, sharing, and integrating with Microsoft Word.">
  <meta property="og:image" content="https://via.placeholder.com/1200x630?text=PDF+to+DOC+Converter">
  <meta property="og:url" content="https://onepagetools.com/pdftodoc.html">
  <meta name="twitter:card" content="summary_large_image">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.1/dist/flowbite.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .fade-in { animation: fadeIn 0.5s ease-out; }
    .scale-in { animation: scaleIn 0.3s ease-out; }
    .hover-scale { transition: transform 0.2s; }
    .hover-scale:hover { transform: scale(1.05); }
    .progress-bar { background: linear-gradient(to right, #4f46e5, #7c3aed); }
    .drop-zone { transition: all 0.3s ease; }
    .drop-zone.dragover { border-color: #4f46e5; background-color: rgba(79, 70, 229, 0.1); }
    .btn { transition: all 0.3s ease; }
    .btn:hover { transform: translateY(-2px); }
    .article-section { max-width: 800px; margin: 0 auto; padding: 2rem 0; }
    .article-section h2 { font-size: 2rem; margin-bottom: 1rem; }
    .article-section h3 { font-size: 1.5rem; margin-top: 2rem; margin-bottom: 1rem; }
    .article-section p { margin-bottom: 1rem; line-height: 1.6; }
    .article-section ul, .article-section ol { list-style-type: disc; margin-left: 2rem; margin-bottom: 1rem; }
    .article-section ol { list-style-type: decimal; }
    .gradient-bg { background: linear-gradient(135deg, #f3f4f6, #e0e7ff); }
  </style>
</head>
<body class="gradient-bg">
  <!-- Navigation -->
  <nav class="bg-white fixed w-full z-20 top-0 start-0 border-b border-gray-200">
    <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
      <a href="https://onepagetools.com/" class="flex items-center space-x-3">
        <img src="One_Page-removebg-preview.png" alt="PDF Converter Logo" style="height: 60px" />
      </a>
      <button data-collapse-toggle="navbar-sticky" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200" aria-controls="navbar-sticky" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"></path>
        </svg>
      </button>
      <div class="items-center justify-between hidden w-full md:flex md:w-auto md:order-1" id="navbar-sticky">
        <ul class="flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg bg-gray-50 md:space-x-8 md:flex-row md:mt-0 md:border-0 md:bg-white">
          <li><a href="./index.html" class="block py-2 px-3 text-black rounded md:bg-transparent md:p-0">Home</a></li>
          <li><a href="./about.html" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0">About</a></li>
          <li><a href="./contact.html" class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0">Contact</a></li>
          <li>
            <button id="dropdownNavbarLink" data-dropdown-toggle="dropdownNavbar" class="flex items-center justify-between w-full py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 md:w-auto">
              ALL CONVERTERS
              <svg class="w-2.5 h-2.5 ms-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4" />
              </svg>
            </button>
            <div id="dropdownNavbar" class="z-10 hidden font-normal bg-white divide-y divide-gray-100 rounded-lg shadow w-44">
              <ul class="py-2 text-sm text-gray-700" aria-labelledby="dropdownLargeButton">
                <li><a href="./pdftoxml.html" class="block px-4 py-2 hover:bg-gray-100">PDF to XML</a></li>
                <li><a href="./pdftoexcel.html" class="block px-4 py-2 hover:bg-gray-100">PDF to Excel</a></li>
                <li><a href="./pdftojpg.html" class="block px-4 py-2 hover:bg-gray-100">PDF to JPG</a></li>
                <li><a href="./xpstopdf.html" class="block px-4 py-2 hover:bg-gray-100">XPS to PDF</a></li>
                <li><a href="./pdftodoc.html" class="block px-4 py-2 hover:bg-gray-100">PDF to DOC</a></li>
              </ul>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="flex justify-center items-center min-h-screen pt-20">
    <div class="container max-w-4xl p-6 bg-white rounded-lg shadow-lg fade-in">
      <h1 class="text-4xl font-bold text-gray-800 mb-4 text-center">PDF to DOC Converter</h1>
      <p class="text-center text-gray-500 mb-6">Convert PDF files to editable DOC format online for free. Perfect for editing, sharing, and integrating with Microsoft Word.</p>

      <!-- File Upload Section -->
      <div class="drop-zone border-4 border-dashed border-gray-200 rounded-xl p-12 text-center mb-8 transition-colors duration-300 hover:border-blue-400" ondragover="handleDragOver(event)" ondrop="handleDrop(event)" ondragleave="handleDragLeave(event)">
        <label for="pdfFiles" class="inline-block w-full py-3 px-5 bg-indigo-600 text-white font-semibold rounded-full cursor-pointer hover:bg-indigo-700 btn hover-scale">
          Choose PDF Files
        </label>
        <input type="file" id="pdfFiles" accept="application/pdf" multiple class="hidden" onchange="previewFiles()">
        <p class="text-gray-500 mt-2">or drag and drop PDF files here (supports multiple files, max 25MB each)</p>
      </div>

      <!-- Conversion Settings -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <div class="bg-gray-50 p-4 rounded-lg">
          <h3 class="text-lg font-semibold mb-3">Conversion Settings</h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Page Range (e.g., 1-3, 5)</label>
              <input type="text" id="pageRange" class="w-full p-2 border rounded-lg" placeholder="All pages">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Output Format</label>
              <select id="outputFormat" class="w-full p-2 border rounded-lg">
                <option value="docx">DOCX (Microsoft Word)</option>
                <option value="doc">DOC (Legacy Word)</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Font Style</label>
              <select id="fontStyle" class="w-full p-2 border rounded-lg">
                <option value="Arial">Arial</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Calibri">Calibri</option>
              </select>
            </div>
          </div>
        </div>
        <div class="bg-gray-50 p-4 rounded-lg">
          <h3 class="text-lg font-semibold mb-3">Output Options</h3>
          <div class="space-y-4">
            <div class="flex items-center gap-2">
              <input type="checkbox" id="preserveLayout" checked>
              <label class="text-gray-600">Preserve Basic Layout</label>
            </div>
            <div class="flex items-center gap-2">
              <input type="checkbox" id="extractImages" checked>
              <label class="text-gray-600">Extract Images</label>
            </div>
            <div class="text-xs text-gray-500 mt-2">Note: Layout preservation works best for simple documents. Complex layouts may require manual adjustments.</div>
          </div>
        </div>
      </div>

      <!-- Preview Section -->
      <div id="previewContainer" class="mb-6"></div>

      <!-- Progress Bar -->
      <div id="progressBar" class="hidden bg-gray-200 rounded-full h-2.5 mb-4">
        <div class="bg-blue-600 h-2.5 rounded-full transition-all duration-300 progress-bar" style="width: 0%"></div>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-wrap gap-4 justify-center">
        <button onclick="convertPDFs()" class="py-3 px-5 bg-indigo-600 text-white font-semibold rounded-full hover:bg-indigo-700 btn hover-scale" id="convertButton" disabled>
          Convert to DOC
        </button>
        <a id="downloadZipButton" href="#" download="converted-docs.zip" class="hidden py-3 px-5 bg-green-600 text-white font-semibold rounded-full hover:bg-green-700 btn hover-scale">
          Download All Files (ZIP)
        </a>
        <button onclick="resetAll()" class="py-3 px-5 bg-red-500 text-white font-semibold rounded-full hover:bg-red-600 btn hover-scale">
          Reset
        </button>
      </div>
    </div>
  </div>

  <!-- SEO-Friendly Article (Same as provided) -->
  <div class="article-section">
    <h2>Ultimate Guide to Using a PDF to DOC Converter Online</h2>
    <p>... Your original article content ...</p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.1/dist/flowbite.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.min.js"></script>

  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

    let files = [];

    function handleDragOver(e) { e.preventDefault(); e.currentTarget.classList.add('dragover'); }
    function handleDragLeave(e) { e.preventDefault(); e.currentTarget.classList.remove('dragover'); }
    function handleDrop(e) {
      e.preventDefault();
      e.currentTarget.classList.remove('dragover');
      const uploadedFiles = e.dataTransfer.files;
      if (uploadedFiles.length) {
        document.getElementById('pdfFiles').files = uploadedFiles;
        previewFiles();
      }
    }

    function previewFiles() {
      const fileInput = document.getElementById('pdfFiles');
      const previewContainer = document.getElementById('previewContainer');
      files = [];
      previewContainer.innerHTML = '';
      document.getElementById('downloadZipButton').classList.add('hidden');

      if (fileInput.files.length) {
        Array.from(fileInput.files).forEach((file, index) => {
          if (file.type !== 'application/pdf') {
            Swal.fire('Invalid File', `${file.name} is not a PDF file.`, 'error');
            return;
          }
          if (file.size > 25 * 1024 * 1024) {
            Swal.fire('File Too Large', `${file.name} exceeds 25MB.`, 'error');
            return;
          }
          const fileData = { file, name: file.name, id: `file-${index}` };
          files.push(fileData);
          renderPreview(fileData);
        });
      }
      document.getElementById('convertButton').disabled = files.length === 0;
    }

    function renderPreview(fileData) {
      const previewContainer = document.getElementById('previewContainer');
      const div = document.createElement('div');
      div.className = 'flex justify-between items-center bg-gray-50 p-4 rounded-lg mb-2 scale-in';
      div.innerHTML = `
        <p class="text-gray-600 truncate">${fileData.name} (${(fileData.file.size / 1024 / 1024).toFixed(2)}MB)</p>
        <div class="flex items-center gap-2">
          <p id="${fileData.id}-status" class="text-gray-500">Pending</p>
          <a id="${fileData.id}-download" href="#" class="hidden text-blue-600 hover:underline">Download</a>
        </div>
      `;
      previewContainer.appendChild(div);
    }
    
    async function getPdfDocument(file, password = null) {
        const arrayBuffer = await file.arrayBuffer();
        const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer, password });
        try {
            return await loadingTask.promise;
        } catch (error) {
            if (error.name === 'PasswordException') {
                const { value: newPassword } = await Swal.fire({
                    title: `Password Required for ${file.name}`,
                    input: 'password',
                    inputPlaceholder: 'Enter password',
                    showCancelButton: true
                });
                if (newPassword) {
                    return getPdfDocument(file, newPassword);
                } else {
                    throw new Error('Password not provided.');
                }
            } else {
                throw error;
            }
        }
    }

    // *** THIS IS THE NEW, FIXED CONVERSION LOGIC ***
    async function processSinglePdf(fileData) {
        const statusEl = document.getElementById(`${fileData.id}-status`);
        const downloadEl = document.getElementById(`${fileData.id}-download`);

        try {
            statusEl.textContent = 'Processing...';

            const pdf = await getPdfDocument(fileData.file);
            const pageRange = document.getElementById('pageRange').value;
            const outputFormat = document.getElementById('outputFormat').value;
            const fontStyle = document.getElementById('fontStyle').value;
            const preserveLayout = document.getElementById('preserveLayout').checked;
            const extractImages = document.getElementById('extractImages').checked;

            const pagesToProcess = parsePageRange(pageRange, pdf.numPages);

            const docSections = [];

            for (const pageNum of pagesToProcess) {
                const page = await pdf.getPage(pageNum);
                const textContent = await page.getTextContent();
                const viewport = page.getViewport({ scale: 1.5 }); // Higher scale for better positioning
                
                const pageChildren = [];

                // --- Process Text ---
                textContent.items.forEach(item => {
                    if (!item.str.trim()) return;

                    const textRun = new docx.TextRun({
                        text: item.str,
                        font: fontStyle,
                        size: item.height * 1.5, // size in half-points
                        bold: item.fontName.includes("Bold"),
                        italics: item.fontName.includes("Italic"),
                    });
                    
                    if (preserveLayout) {
                        // In DOCX, absolute positioning is complex. We simulate it with paragraphs.
                        // This is a simplified approach.
                        pageChildren.push(new docx.Paragraph({ children: [textRun], spacing: { before: item.transform[5] / 2 } }));
                    } else {
                         pageChildren.push(new docx.Paragraph({ children: [textRun] }));
                    }
                });

                // --- Process Images ---
                if (extractImages) {
                    const opList = await page.getOperatorList();
                    for (let i = 0; i < opList.fnArray.length; i++) {
                        if (opList.fnArray[i] === pdfjsLib.OPS.paintImageXObject) {
                            try {
                                const imgKey = opList.argsArray[i][0];
                                const img = page.objs.get(imgKey);
                                if (img && img.data) {
                                    // Use the raw image data buffer, which is more robust
                                    const imageRun = new docx.ImageRun({
                                        data: img.data,
                                        transformation: {
                                            width: img.width,
                                            height: img.height,
                                        },
                                    });
                                    pageChildren.push(new docx.Paragraph({ children: [imageRun] }));
                                }
                            } catch (imgError) {
                                console.warn(`Could not process an image in ${fileData.name}:`, imgError);
                            }
                        }
                    }
                }
                
                docSections.push({
                    properties: {
                        type: docx.SectionType.NEXT_PAGE,
                        page: {
                            size: { width: viewport.width, height: viewport.height },
                            orientation: viewport.width > viewport.height ? docx.PageOrientation.LANDSCAPE : docx.PageOrientation.PORTRAIT,
                        },
                    },
                    children: pageChildren,
                });
            }

            const doc = new docx.Document({ sections: docSections });

            const blob = await docx.Packer.toBlob(doc);
            
            downloadEl.href = URL.createObjectURL(blob);
            downloadEl.download = `${fileData.name.replace('.pdf', '')}.${outputFormat}`;
            downloadEl.classList.remove('hidden');
            statusEl.textContent = 'Converted';
            
            return { name: `${fileData.name.replace('.pdf', '')}.${outputFormat}`, blob };

        } catch (error) {
            console.error(`Failed to convert ${fileData.name}:`, error);
            statusEl.textContent = 'Error';
            statusEl.classList.add('text-red-500');
            return null; // Indicate failure
        }
    }

    async function convertPDFs() {
        if (!files.length) return;

        const progressBar = document.getElementById('progressBar');
        const progressFill = progressBar.querySelector('div');
        progressBar.classList.remove('hidden');

        const zip = new JSZip();
        let convertedFiles = [];

        for (let i = 0; i < files.length; i++) {
            const result = await processSinglePdf(files[i]);
            if (result) {
                convertedFiles.push(result);
            }
            const progressPercentage = ((i + 1) / files.length) * 100;
            progressFill.style.width = `${progressPercentage}%`;
        }

        if (convertedFiles.length > 1) {
            convertedFiles.forEach(file => {
                zip.file(file.name, file.blob);
            });
            const zipBlob = await zip.generateAsync({ type: 'blob' });
            const downloadZipButton = document.getElementById('downloadZipButton');
            downloadZipButton.href = URL.createObjectURL(zipBlob);
            downloadZipButton.classList.remove('hidden');
        }

        Swal.fire('Success!', 'All files have been processed.', 'success');
        setTimeout(() => progressBar.classList.add('hidden'), 2000);
    }
    
    function parsePageRange(range, totalPages) {
      if (!range.trim()) return Array.from({ length: totalPages }, (_, i) => i + 1);
      const pages = new Set();
      const parts = range.split(',');
      for (const part of parts) {
        if (part.includes('-')) {
          const [start, end] = part.split('-').map(Number);
          if (!isNaN(start) && !isNaN(end)) {
            for (let i = Math.max(1, start); i <= Math.min(totalPages, end); i++) pages.add(i);
          }
        } else {
          const page = Number(part);
          if (!isNaN(page) && page >= 1 && page <= totalPages) pages.add(page);
        }
      }
      return Array.from(pages).sort((a, b) => a - b);
    }

    function resetAll() {
      files = [];
      document.getElementById('previewContainer').innerHTML = '';
      document.getElementById('pdfFiles').value = '';
      document.getElementById('pageRange').value = '';
      document.getElementById('outputFormat').value = 'docx';
      document.getElementById('fontStyle').value = 'Arial';
      document.getElementById('preserveLayout').checked = true;
      document.getElementById('extractImages').checked = true;
      document.getElementById('downloadZipButton').classList.add('hidden');
      document.getElementById('progressBar').classList.add('hidden');
      document.getElementById('convertButton').disabled = true;
    }
  </script>
</body>
</html>